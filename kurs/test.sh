#!/bin/bash

# run_all_tests.sh - Главный скрипт функционального тестирования

LOG_FILE="functional_test.log"
CLIENT_BIN="./main"  # Укажите правильное имя вашего бинарного файла

echo "=================================================="
echo "Функциональное тестирование клиента"
echo "Запуск: $(date)"
echo "=================================================="

# Проверяем наличие бинарного файла
if [ ! -f "$CLIENT_BIN" ]; then
    echo "ОШИБКА: Файл $CLIENT_BIN не найден!"
    echo "Скомпилируйте программу перед запуском тестов"
    exit 1
fi

# Очищаем лог-файл
> "$LOG_FILE"

# Делаем скрипты исполняемыми
chmod +x test_*.sh

echo "Запуск тестов..."
echo ""

# Запускаем тесты по порядку
./test_help.sh
./test_missing_params.sh 
./test_file_errors.sh
./test_network_errors.sh
./test_auth_errors.sh
./test_success_case.sh

echo ""
echo "=================================================="
echo "Тестирование завершено: $(date)"
echo "Результаты сохранены в: $LOG_FILE"
echo "=================================================="

# Показываем итоговую статистику
echo ""
echo "ИТОГОВАЯ СТАТИСТИКА:"
echo "==================="
grep -c "Итог: Пройден" "$LOG_FILE" | xargs echo "Пройдено тестов:"
grep -c "Итог: Не пройден" "$LOG_FILE" | xargs echo "Провалено тестов:"